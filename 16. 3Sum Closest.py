class Solution:
    """в какой-то момент перестало проходить, хотя раньше проходило, можно попробовать загнать все в 1 функцию"""
    def threeSumClosest(self, nums: list[int], target: int) -> int:
        nums.sort()
        result = sum(nums[:3])
        min_diff = target - result
        for i in range(0, len(nums) - 2):
            two_result = self.twoSumClosest(nums, i + 1, len(nums) - 1, target - nums[i])
            curr = nums[i] + two_result
            result, min_diff = min(
                (result, min_diff),
                (curr, abs(target - curr)),
                key=lambda x:x[1],
            )
        return result
        
        
    def twoSumClosest(self, nums: list[int], l: int, r: int, target: int) -> int:
        start = l
        end = r
        result = nums[start] + nums[end]
        min_diff = abs(target - result)
        while start < end:
            curr = nums[start] + nums[end]
            if curr == target:
                return target
            elif curr < target:
                start += 1
            else:
                end -=1
            result, min_diff = min(
                (result, min_diff),
                (curr, abs(target - curr)),
                key=lambda x:x[1],
            )
        return result

print(Solution().threeSumClosest(
    [-707,633,196,460,-826,492,-972,-78,628,711,66,558,958,-554,-243,-624,-518,-259,-930,-925,-325,122,959,-367,174,-327,-680,-810,-958,-198,738,237,-358,-432,-119,97,-86,-993,388,-766,-513,-117,779,780,-103,-420,-478,702,55,-718,-965,270,945,-576,-223,-212,-806,-552,581,252,-29,482,-417,-349,-903,519,-145,515,429,773,-170,-613,117,262,-139,842,644,314,144,-181,730,209,-962,127,-557,-777,274,931,-412,599,467,-229,865,104,-70,569,-904,293,426,39,-288,-96,956,-561,150,638,83,-334,932,-645,745,-976,-42,26,544,375,-733,272,-796,984,-425,187,-627,573,759,-158,408,-623,-617,-411,-789,-256,-656,-177,348,-379,825,647,-950,-964,-580,-95,-294,-620,940,-79,856,-781,-582,-452,447,501,-98,-981,896,-207,-732,-405,550,409,64,-756,164,470,986,17,642,-861,-779,-312,328,556,848,-424,997,524,-426,497,891,-264,-951,45,32,944,560,-141,-555,477,-842,890,602,458,434,-587,-985,-348,378,695,-607,-235,494,858,-118,-398,-203,-575,-423,80,-436,-283,649,334,-838,-571,794,-685,-19,245,-63,-156,-530,686,22,783,-179,198,597,397,264,202,843,116,265,428,608,-734,-491,-237,-844,-765,-505,-122,793,-73,161,-573,828,-986,443,992,135,3,-751,-875,251,107,639,-900,-848,-182,795,-296,801,-263,-455,674,-928,186,120,-896,-568,495,-944,854,-345,-34,750,491,-886,273,942,320,-615,967,-464,365,721,-522,505,30,-440,-952,971,907,457,-832,802,752,396,287,218,-164,487,-427,640,-663,-933,197,-970,681,372,2,-200,-632,-232,-477,-533,10,-376,845,-104,546,337,-785,158,-941,427,-811,-517,463,-437,412,718,749,418,188,-10,862,-998,-26,-129,21,824,-773,586,-746,-679,-12,309,-687,-631,171,-592,-396,-88,662,-24,-698,95,-948,-920,-616,130,-728,-545,289,453,983,-431,-371,-462,244,468,812,192,305,-837,-905,-739,-28,-889,-926,-18,-519,-359,-724,496,-527,667,367,-185,-589,-816,894,255,419,211,-807,742,-795,88,275,236,-894,-148,-418,-863,319,781,223,214,312,167,-499,-37,131,514,535,-830,-463,949,747,207,-774,75,241,-528,679,-602,-697,740,222,155,-674,-743,-435,-393,908,-604,76,49,754,230,603,78,913,455,-971,-812,-768,-508,-633,-126,-652,-439,52,-146,-483,-778,-108,221,844,-599,900,-389,-152,624,-759,-767,538,11,266,-354,38,993,368,-75,111,724,-52,292,-380,-885,297,-750,185,-938,962,-125,-696,511,217,-271,809,256,892,307,112,-331,407,-975,630,299,-772,310,-872,-888,861,-749,346,-689,788,-945,594,377,-496,-301,-942,-634,359,-224,-21,814,147,403,352,253,-299,-577,67,885,-58,-186,23,671,585,436,284,990,601,852,-23,625,-801,-959,448,-61,-650,-845,465,548,502,725,880,622,-873,-619,304,867,191,343,-321,-668,-387,243,485,-692,283,332,-653,914,486,701,-531,-953,360,146,-5,924,939,-610,-596,-385],
    -9429
))